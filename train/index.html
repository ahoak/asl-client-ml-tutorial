<!DOCTYPE html>
<html lang="en">

<head>
    <title>ASL Fingerspelling Model Tutorial</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Train ASL Fingerspelling ML Model using Tensorflowjs" />
    <meta name="og:description" content="Train ASL Fingerspelling ML Model using Tensorflowjs" />
    <meta property="og:image" content="images/ghc_logo_v4.svg" />
    <meta property="og:title" content="ASL Fingerspelling Model Tutorial" />
    <meta name="twitter:card" content="summary" />
    <link rel="stylesheet" type="text/css" href="/asl-client-ml-tutorial/styles/style.css" />
    
    <meta name="theme-color" content="#9480FF" />
    
    <link rel="manifest" href="/asl-client-ml-tutorial/manifest.json">
    <script>
    
      // if ('serviceWorker' in navigator) {
      //   navigator.serviceWorker.register('sw.js')
      //     .then(reg => console.log('Service Worker registered', reg))
      //     .catch(err => console.error('Service Worker **not** registered', err));
      // }
    
    </script>
    <div class="nav-links">
      <a href="/asl-client-ml-tutorial/" id="home" class>üè† Home</a>
      <a href="/asl-client-ml-tutorial/train" id="build">üî® Build</a>
      <a href="/asl-client-ml-tutorial/predict" id="predict">‚ú® Predict</a>
    </div>
    <link rel="stylesheet" type="text/css" href="/asl-client-ml-tutorial/styles/themes/glitch.css" />
  <script type="module" crossorigin src="/asl-client-ml-tutorial/assets/train.4a9cf73a.js"></script>
  <link rel="modulepreload" crossorigin href="/asl-client-ml-tutorial/assets/utils.42908397.js">
  <link rel="modulepreload" crossorigin href="/asl-client-ml-tutorial/assets/WebcamSelector.e687d297.js">
  <link rel="stylesheet" href="/asl-client-ml-tutorial/assets/WebcamSelector.1bd16a3c.css">
</head>

<body>
    <main>
        <div class="wrapper">
            <div class="content">
<!-- This alignment is because of some pre-formatted text contained within-->
<div class="training-container">
    <fluent-breadcrumb slot="header" class="breadcrumbs">
      <fluent-breadcrumb-item step="1" id="tutorial-step1">
        <a href="#step1">Load Data</a>
        <span class="step-status"></span>
      </fluent-breadcrumb-item>
      <fluent-breadcrumb-item step="2" id="tutorial-step2">
        <a href="#step2">Create and Configure Model</a>
        <span class="step-status"></span>
      </fluent-breadcrumb-item>
      <fluent-breadcrumb-item step="3" id="tutorial-step3">
        <a href="#step3">Train Model</a>
        <span class="step-status"></span>
      </fluent-breadcrumb-item>
      <fluent-breadcrumb-item step="4" id="tutorial-step4">
        <a href="#step4">Download Model Files</a>
        <span class="step-status"></span>
      </fluent-breadcrumb-item>
    </fluent-breadcrumb>
  <div class="next-button-container">
    <fluent-button class="train-button" appearance="accent">
      Next
    </fluent-button>
    <div class="training-controls">
      <fluent-button class="training-start-button">Start training</fluent-button>

      <fluent-button class="training-stop-button">Stop training</fluent-button>
    </div>
    <div class="download-controls">
      <fluent-button class="download-button">Download</fluent-button>

    </div>

  </div>

  <p id="validation-status" role="status" aria-live="polite"></p>
  <div class="training-feedback-container">
  </div>

  <div class="bottom-button-container">
    <fluent-button class="solve-button" style="display: none;" appearance="accent">Solve</fluent-button>

    <fluent-button class="reset-button" style="display: none;">Reset</fluent-button>
  </div>


  <fluent-tabs activeid="code-tab" class="fluent-tab-container">
    <fluent-tab id="code-tab">Code</fluent-tab>
    <fluent-tab id="solution-tab">Solution</fluent-tab>
    <fluent-tab id="instructions-tab">Instructions</fluent-tab>
    <fluent-tab-panel id="codePanel">

      <code-step name="loadData" step="1" code="function step1() {}" style="display: none;"
        allow-background-execution>
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>
      <code-step name="createModel" step="2" code="function step2() {}" style="display: none;"
        allow-background-execution>
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>
      <code-step name="trainModel" step="3" code="function step3() {}" style="display: none;"
        allow-background-execution>
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>
      <code-step name="exportModel" step="4" code="function step4() {}" style="display: none;"
        allow-background-execution>
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>

    </fluent-tab-panel>
    <fluent-tab-panel id="solutionPanel">
      <code-step name="loadData-solution" step="11" code="function step11() {}"
        style="display: none;" read-only="true">
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>
      <code-step name="createModel-solution" step="21" code="function step21() {}"
        style="display: none;" read-only="true">
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>
      <code-step name="trainModel-solution" step="31" code="function step31() {}"
        style="display: none;" read-only="true">
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>
      <code-step name="exportModel-solution" step="41" code="function step41() {}"
        style="display: none;" read-only="true">
        <!-- hide success, we have our own -->
        <div slot="success"></div>
      </code-step>

    </fluent-tab-panel>
    <fluent-tab-panel id="instructionPanel">


      <div class="instructions-image" id="loadData-image" style="display: none">
<!-- This alignment is because of some pre-formatted text contained within-->
<ol>
<li>Use the <a href="https://google.github.io/mediapipe/solutions/hands.html">MedialPipe Hands Model</a> to extract the set of joint positions of each image in the dataset.<br>
<img src="/asl-client-ml-tutorial/instructions/load_data_asset1.png" alt="mediapipe hands datapoints"></li>
<li>Flatten the joint positions into an array of values with the format:<br>
<code>[x_1,y_1,z_1,x_2,y_2,z_2 ... x_21, y_21, z_21]</code></li>
<li>Normalize the flattened joint positions so that the values are scaled from -1 to 1.</li>
<li>Shuffle the data.</li>
<li>Use <a href="https://www.geeksforgeeks.org/what-is-one-hot-design/">one-hot encoding</a> to transform the letter labels (i.e. 'A', 'B', 'C'...) to a machine-friendly data format.<br>
<img src="/asl-client-ml-tutorial/instructions/load_data_asset2.png" alt="one hot encoding example"></li>
<li>Split data into a training dataset, validation dataset, and test dataset.<br>
<img src="/asl-client-ml-tutorial/instructions/load_data_asset3.png" alt="data split illustration"></li>
</ol>
      </div>

      <div class="instructions-image" id="createModel-image" style="display: none">
<!-- This alignment is because of some pre-formatted text contained within-->
<ol>
<li><strong>Create model architecture using <a href="https://js.tensorflow.org/api/latest/#sequential">tf.sequential()</a> API.</strong><br>
This will create a model which executes sequentially, where the outputs of one layer are the inputs for the next layer.<br>
We will create our model by adding layers using tf.layers.dense() API.<br>
Dense layers means each neuron in the layer is fully connected to all inputs. Activation functions will produce output if values cross some threshold.</li>
</ol>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> model = tf.sequential({
  <span class="hljs-attr">layers</span>: [
    <span class="hljs-comment">// INPUT LAYER  </span>
    tf.layers.dense({ <span class="hljs-attr">inputShape</span>: [<span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>], <span class="hljs-attr">units</span>: <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, <span class="hljs-attr">activation</span>: <span class="hljs-string">'relu'</span> }),
    <span class="hljs-comment">// HIDDEN LAYER  </span>
    tf.layers.dense({ <span class="hljs-attr">units</span>: <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, <span class="hljs-attr">activation</span>: <span class="hljs-string">'relu'</span> }),
    <span class="hljs-comment">// OUTPUT LAYER  </span>
    tf.layers.dense({ <span class="hljs-attr">units</span>: <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, <span class="hljs-attr">activation</span>: <span class="hljs-string">'softmax'</span> }),
  ],
});
</code></pre>
<blockquote>
<p><strong>‚ú®Input Layer</strong><br>
Fill in the inputShape and units (number of neurons) based on our feature values<br>
(hint this is equal to mediapipe hands joint positions per image = 63)</p>
</blockquote>
<blockquote>
<p><strong>‚ú®Hidden Layer</strong><br>
Choose number of neurons for the hidden layer.<br>
We suggest in range 100-300 neurons.</p>
</blockquote>
<blockquote>
<p><strong>‚ú®Output Layer</strong><br>
Add final layer with number of neurons equal to the letter classes (i.e classes.length).</p>
</blockquote>
<blockquote>
<p><img src="instructions/create_model_asset1.png" alt="model overview"></p>
</blockquote>
<blockquote>
<p><strong>Softmax Activation</strong>: used for classification and requires mutually exclusive prediction outputs. This produces values that add to 1.</p>
</blockquote>
<blockquote>
<p><strong>Rectified Linear Unit (ReLU) Activation</strong>: returns 0 if neuron output value is less than 0 and returns value in all other cases.</p>
</blockquote>
<ol start="2">
<li><strong>Configure model using <a href="https://js.tensorflow.org/api/latest/#tf.LayersModel.compile">model.compile()</a>.</strong>  <br>
Here we can fine tune our model by providing optimizer and loss functions.<br>
The model will initialize with random values to weights and bias.<br>
Neurons improve accuracy by adjusting weights and biases during training.<br>
We measure how incorrect our model predictions are with our loss function. Our goal is to minimize loss.<br>
The optimizer defines how to tweak the parameters to get closer to minimum loss.</li>
</ol>
<pre><code class="language-javascript">model.compile({
  <span class="hljs-comment">// optimizer options: 'sgd', 'adam', 'adamax', 'momentum'</span>
  <span class="hljs-attr">optimizer</span>:  <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, 
  <span class="hljs-comment">// loss options: 'categoricalCrossentropy' , 'binaryCrossentropy'</span>
  <span class="hljs-attr">loss</span>:  <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, 
  <span class="hljs-attr">metrics</span>: [<span class="hljs-string">'accuracy'</span>],
})
</code></pre>
<blockquote>
<p><strong>‚ú®<a href="https://js.tensorflow.org/api/latest/#class:train.Optimizer">Optimizer Function</a></strong>: Choose an optimizer (options include 'sgd', 'adam', 'momentum', 'adamax').</p>
</blockquote>
<blockquote>
<p><strong>‚ú®<a href="https://js.tensorflow.org/api/latest/#Training-Losses">Loss Function</a></strong>: Choose loss function, we suggest ‚ÄòcategoricalCrossentropy‚Äô since our output is greater than 3 and has a probability distribution.</p>
</blockquote>
      </div>

      <div class="instructions-image" id="trainModel-image" style="display: none">
<!-- This alignment is because of some pre-formatted text contained within-->
<ol>
<li>Train our model by using the async function <a href="https://js.tensorflow.org/api/latest/#tf.LayersModel.fit">model.fit()</a>.  This will adjust the weights and bias to learn from the data.</li>
</ol>
<pre><code class="language-javascript"><span class="hljs-keyword">await</span> model.fit( <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, {
    <span class="hljs-attr">epochs</span>: numEpochs, <span class="hljs-comment">// default = 5 </span>
    <span class="hljs-attr">batchSize</span>: <span class="hljs-number">128</span>, 
    <span class="hljs-attr">verbose</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">validationData</span>: [<span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>, <span class="hljs-comment">/*‚ú®INSERT_HERE‚ú®*/</span>],
    <span class="hljs-attr">callbacks</span>: callbacks
});
</code></pre>
<p><strong>‚ú®Training Data</strong> : You will need to define the input data as a tensor (<code>inputs</code>) and the output data as a tensor (<code>outputs</code>) as parameters in model.fit().</p>
<p><strong>‚ú®Validation Data</strong> : Add the validation data (inputValidation,  outputValidation) to evaluate model performance.</p>
<p><em>Model.fit() method also accepts parameters such as epochs, batchSize, and callbacks.</em><br>
<strong>batchSize</strong>: number of training examples before calculating loss and optimizes weights and biases.<br>
<strong>epochs</strong>: number of times the model will go through the entire training dataset.<br>
<strong>callbacks</strong>: callback functions to hook into in order to track progress.</p>
<p>Whenever we create tensors we need to remove them from memory for best performance. We can do this with the <a href="https://js.tensorflow.org/api/latest/#tf.Tensor.dispose">tensor.dispose()</a> method.</p>
<pre><code class="language-javascript">inputs.dispose()
</code></pre>
<p>When you feel your model is ready to train, click 'Start training' button.</p>
      </div>

      <div class="instructions-image" id="exportModel-image" style="display: none">
<!-- This alignment is because of some pre-formatted text contained within-->
<ol>
<li>We can export our model for use in our application by using the <a href="https://js.tensorflow.org/api/latest/#tf.LayersModel.save">model.save()</a> method. Here we are exporting a model as a zip folder to download locally.This saves the model topology (model.json) and weights (binary files).<br>
We are also using the following method to download to localstorage:</li>
</ol>
<pre><code class="language-javascript"><span class="hljs-keyword">await</span> model.save(<span class="hljs-string">'localstorage://model'</span>);
</code></pre>
<blockquote>
<p>Press the <strong>'Download'</strong> button.</p>
</blockquote>
<blockquote>
<p>Continue to the <strong>'Predict'</strong> tab when download is complete.</p>
</blockquote>
      </div>

    </fluent-tab-panel>
  </fluent-tabs>







  <!--  -->
</div>                <div class="content">
                  <div class="social-icons">
                
                
                    <a aria-label="ASL Fingerspelling Tutorial üëã on GitHub" href="https://github.com/ahoak/asl-client-ml-tutorial">
                      <svg class="social-profile-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M10.026 0C4.517 0 0.052002 4.465 0.052002 9.974C0.052002 14.38 2.909 18.119 6.873 19.439C7.372 19.529 7.552 19.222 7.552 18.958C7.552 18.721 7.544 18.093 7.541 17.262C4.766 17.864 4.18 15.924 4.18 15.924C3.728 14.772 3.073 14.465 3.073 14.465C2.168 13.846 3.142 13.86 3.142 13.86C4.144 13.93 4.669 14.888 4.669 14.888C5.559 16.412 7.005 15.972 7.571 15.717C7.662 15.072 7.922 14.632 8.206 14.383C5.992 14.132 3.664 13.276 3.664 9.453C3.664 8.366 4.053 7.474 4.688 6.778C4.587 6.525 4.242 5.51 4.787 4.138C4.787 4.138 5.624 3.869 7.529 5.159C8.327 4.938 9.178 4.827 10.025 4.823C10.874 4.827 11.726 4.938 12.521 5.159C14.427 3.868 15.263 4.138 15.263 4.138C15.808 5.51 15.466 6.525 15.362 6.778C16.002 7.474 16.386 8.365 16.386 9.453C16.386 13.286 14.056 14.128 11.834 14.375C12.189 14.683 12.509 15.291 12.509 16.221C12.509 17.555 12.497 18.631 12.497 18.958C12.497 19.225 12.675 19.535 13.184 19.437C17.146 18.115 20 14.379 20 9.974C20 4.465 15.535 0 10.026 0Z"
                          fill="#2E3A59" />
                      </svg>
                    </a>
                
                
                
                    <a aria-label="ASL Fingerspelling Tutorial üëã on Twitter" href="https://twitter.com/amber_hoak">
                      <svg class="social-profile-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M22.162 5.65593C21.3986 5.99362 20.589 6.2154 19.76 6.31393C20.6337 5.79136 21.2877 4.96894 21.6 3.99993C20.78 4.48793 19.881 4.82993 18.944 5.01493C18.3146 4.34151 17.4804 3.89489 16.5709 3.74451C15.6615 3.59413 14.7279 3.74842 13.9153 4.18338C13.1026 4.61834 12.4564 5.30961 12.0771 6.14972C11.6978 6.98983 11.6067 7.93171 11.818 8.82893C10.1551 8.74558 8.52832 8.31345 7.04328 7.56059C5.55823 6.80773 4.24812 5.75097 3.19799 4.45893C2.82628 5.09738 2.63095 5.82315 2.63199 6.56193C2.63199 8.01193 3.36999 9.29293 4.49199 10.0429C3.828 10.022 3.17862 9.84271 2.59799 9.51993V9.57193C2.59819 10.5376 2.93236 11.4735 3.54384 12.221C4.15532 12.9684 5.00647 13.4814 5.95299 13.6729C5.33661 13.84 4.6903 13.8646 4.06299 13.7449C4.32986 14.5762 4.85 15.3031 5.55058 15.824C6.25117 16.3449 7.09712 16.6337 7.96999 16.6499C7.10247 17.3313 6.10917 17.8349 5.04687 18.1321C3.98458 18.4293 2.87412 18.5142 1.77899 18.3819C3.69069 19.6114 5.91609 20.264 8.18899 20.2619C15.882 20.2619 20.089 13.8889 20.089 8.36193C20.089 8.18193 20.084 7.99993 20.076 7.82193C20.8949 7.23009 21.6016 6.49695 22.163 5.65693L22.162 5.65593Z"
                          fill="black" />
                      </svg>
                    </a>
                  </div>
                </div>                
            </div>
        </div>

    </main>

</body>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/github.min.css">

</html>